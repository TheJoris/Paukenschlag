\section{Noise in transcriptional regulation}

\subsection{\alabel{noise:corr_time} Variance, correlation time and power spectra}
From the appendix of \cite{DeRonde2012}. The time-average of an observable $A\br{t}$\cite{Frenkel2002} is defined as
\begin{align}
\elabel{si:time_av_mean}
A_T=\frac{1}{T}\int_0^T dt A\br{t}
\end{align}
and the variance of the time-averaged mean $\sigma^2_{A_T}$ is
\begin{align}
\sigma^2_{A_T}&\br{T}=\avg{A^2_T}-\br{\frac{1}{T}\int \avg{A\br{t}}dt}^2\\
&=\frac{1}{T^2}\int_0^T  \int_0^T dt dt' \avg{A\br{t}A\br{t'}}-\avg{A_T}^2\\
\elabel{si:time_av_var2}
&=\frac{1}{T^2}\int_0^T dt \int_{-t}^{T-t} d\tau \avg{A\br{0}A\br{t'-t}}-\avg{A_T}^2\\
\elabel{si:time_av_var3}
&=\frac{1}{T^2}\int_0^T dt\int_{-t}^{T-t} d\tau \avg{A\br{0}A\br{\tau}}-\avg{A}^2,
\end{align}
where for \eref{si:time_av_var2} the process is assumed to be stationary and we define $\tau=t'-t$.
The correlation function for this observable $A\br{t}$ is defined as
\begin{align}
\elabel{si:time_corr_ens}
C\br{t,t'}&=\avg{\br{A\br{t'}-\avg{A}}\br{A\br{t}-\avg{A}}}\\
\elabel{si:time_corr_ens_1}
C\br{\tau}&=\avg{\br{A\br{\tau}-\avg{A}}\br{A\br{0}-\avg{A}}}\\
\elabel{si:time_corr_ens_2}
&=\avg{A\br{0}A\br{\tau}}-\avg{A}^2
\end{align}

Substitution of \eref{si:time_corr_ens_2} into \eref{si:time_av_var3} leads to
\begin{align}
\sigma^2_{A_T}\br{T}&=\frac{1}{T^2}\int_0^T dt \int_{-t}^{T-t} d\tau C\br{\tau}+\frac{1}{T}\int_0^T \avg{A}^2-\avg{A}^2\\
\elabel{si:time_av_var4}
&=\frac{1}{T^2}\int_0^T dt \int_{-t}^{T-t} d\tau C\br{\tau}.
\end{align}
In the limit of small $T$ and large $T$ a solution for \eref{si:time_av_var4} can be obtained
\begin{align}
\elabel{si:limT_0_corr}
&\sigma^2_{A_T}\br{0}=C\br{0}=\sigma_A^2\\
\elabel{si:limT_infty_corr}
&\lim_{T\to\infty}\approx \lim_{T\gg \tau_A}=\sigma^2_{A_T}\br{T\gg \tau_A}=\frac{1}{T^2}\int_0^T dt \int_{-\infty}^{\infty} d\tau
C\br{\tau}\nonumber\\
&\quad\qquad\qquad=\frac{2\sigma_A^2\tau_A}{T},
\end{align}
where we used the fact that $\lim_{\tau\gg\tau_A} C\br{\tau}=0$. We introduced the correlation time $\tau_A$ in \eref{si:limT_infty_corr}
which is commonly defined as
\begin{align}
\elabel{si:corr_time}
\tau_A\equiv \frac{1}{\sigma^2_A}\int_0^\infty C\br{\tau} d\tau
\end{align}
As an example, for a process $A\br{t}$ with exponential waiting times, $C\br{\tau}\propto e^{-k \tau}$ and $\int C\br{\tau}d\tau \propto
k^{-1} \sim \tau_A$.

The power spectrum ($P_A\br{\omega}$) and correlation function are related through the Fourier Transform
\begin{align}
\elabel{si:rel_pow_lap}
C_A\br{\tau}&=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty d\omega P_A\br{\omega}e^{i\omega\tau}\\
P_A\br{\omega}&=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty d\tau C_A\br{\tau}e^{-i\omega\tau}
\end{align}
such that
\begin{align}
C_A\br{0}&=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty d\omega P_A\br{\omega}=\sigma_A^2\\
P_A\br{0}&=\frac{1}{\sqrt{2\pi}}\int_{-\infty}^\infty d\tau C_A\br{\tau}\equiv 2\sigma_A^2\tau_A=T\sigma^2_{A_T}
\end{align}
where $\tau_A$ is the correlation time (see \eref{si:corr_time}).

For comparison with the paper of Tka$\check{\rm c}$ik \cite{Tkacik2009} we write the low $\omega$ limit of the power spectrum (\aref{noise:corr_time}) as
\begin{equation}
 S_n(\omega \to 0) = \frac{2 \bar{n}(1-\bar{n})^2}{k_-} + \frac{2\bar{n}^2(1-\bar{n})}{\bar{\xi} k_D}.
 \elabel{Sn}
\end{equation}

For a Poisson process with correlation time $\tau_c$, the power spectrum is
\begin{equation}
 P_A(\omega) = 2 \sigma_A \frac{\tau_c^{-1}}{\tau_c^{-2} + \omega^2}
 \elabel{PoissonPow}
\end{equation}


\subsection{\alabel{noise:limits_Laplace} Limits in Laplace space}
Here we show how we can obtain the large time limits of a function, given it's sollution in Laplace space. First, we can find the time integral of an arbitrary function by taking the limit
\begin{align}
\lim_{s \to 0} \hat{A}(s) = \int_0^\infty A(t) dt.
\elabel{si:int_vs_lap}
\end{align}
The long time limit of a function is given by
\begin{align}
\lim_{s \to 0} s \, \hat{A}(s) = \lim_{t \to \infty} A(t).
\elabel{si:longt_in_lap}
\end{align}
And, in the same spirit
\begin{align}
\lim_{s \to 0} s^2 \, \hat{A}(s) = \lim_{t \to \infty} \partial_t A(t).
\elabel{si:longt_in_lap2}
\end{align}


\subsection{\alabel{noise:backward_eqn} The backward Smoluchowski equation}
Here we prove that the flux into a sink with a radiation boundary condition, in an equilibrated sytem of particles, is given by
\begin{equation}
 k(t) = k_+ \, S(t|\sigma).
 \elabel{bsm_k}
\end{equation}
To start, we show how to obtain the backward Kolmogorov equation from the forward Smoluchowski equation. The forward equation is defined as
\begin{eqnarray}
 \pdiff{p(\vect{r},t|\vect{r_0})}{t} & = & r^{1-d} \pdiff{}{r} D r^{d-1} e^{-V(r)} \pdiff{}{r} e^{V(r)} p(\vect{r},t|\vect{r_0}) \\
 & = & \mathscr{L}_{\vect{r}} p(\vect{r},t|\vect{r_0})
\end{eqnarray}
where $\mathscr{L}_{\vect{r}}$ is the 'diffusion operator' acting on the coordinate $\vect{r}$. Because $p$ is a Green's function, we can write
\begin{multline}
\pdiff{p(\vect{r},t|\vect{r_0})}{t} = \int d\vect{r}' \left(\pdiff{}{t} p(\vect{r},t-t'|\vect{r}') \right) p(\vect{r}',t'|\vect{r_0}) \\
 = \int d\vect{r}' \left( - \pdiff{}{t'} p(\vect{r},t - t'|\vect{r}') p(\vect{r}',t'|\vect{r_0}) \right) + p(\vect{r},t - t'|\vect{r}') \left( \pdiff{}{t'} p(\vect{r}',t'|\vect{r_0}) \right) 
\end{multline}
where, in the second line, we let the time derivative act on $t'$. Furthermore we let it act on both Green's functions and compensate with the second term. The integral over ${\bf r'}$ acts on all terms. Because $p(\vect{r},t|\vect{r_0})$ describes a Markov process, it doesn't depend on the intermediate time $t'$, so the first term cancels. Invoking the diffusion equation for the time operator in the remaining term we get
\begin{eqnarray}
 \pdiff{p(\vect{r},t|\vect{r_0})}{t} & = & \int d\vect{r}' p(\vect{r},t - t'|\vect{r}') \left[ \mathscr{L}_{\vect{r}'}^{\phantom{\dag}} p(\vect{r}',t'|\vect{r_0}) \right] \\
 & = & \int d\vect{r}' \left[ \mathscr{L}_{\vect{r'}}^{\dag} p(\vect{r},t - t'|\vect{r}') \right] \, p(\vect{r}',t'|\vect{r_0}). \elabel{bsm_1}
\end{eqnarray}
In the second line we applied integration by parts twice and threw away the boundary terms. If we let the arbitrary timepoint $t'$ go to zero in \eref{bsm_1}, the second Green's function changes into $\delta(\vect{r}-\vect{r}')$ and the integral vanisches. The result is the backward Kolmogorov equation
\begin{eqnarray}
 \elabel{backward_eqn}
 \pdiff{p(\vect{r},t|\vect{r_0})}{t} & = & \mathscr{L}_{\vect{r_0}}^{\dag} p(\vect{r},t|\vect{r_0}) \\
 & = & r_0^{1-d} e^{V(r_0)} \pdiff{}{r_0} D r_0^{d-1} e^{-V(r_0)} \pdiff{}{r_0} p(\vect{r},t|\vect{r_0}). 
\end{eqnarray}
Integrating both sides to $\vect{r}$ we get
\begin{equation}
 \pdiff{S(t|\vect{r_0})}{t} = \mathscr{L}_{\vect{r_0}}^{\dag} S(t|\vect{r_0}).
 \elabel{S_eqn}
\end{equation}
In words, the forward equation tells us what the probability is to end up in $\vec{r}$ at time $t$, given that you started in $\vec{r_0}$ at time zero. The backward equation tells you the probability to have started in $\vec{r}_0$ at time zero, given that you end up in $\vec{r}$ at time $t$. Without a potential, these two Green's functions are equivalent.

To prove \eref{bsm_k}, we show that the initial condition and the time derivative of both the influx and the survival probability $S(t|\sigma)$ are the same. The influx at a radiation boundary from an equilibrium is
\begin{equation}
 k(t) = k_+ \left. \int d\vect{r_0} p(\vect{r},t|\vect{r_0}) \right|_{r=\sigma}.
 \elabel{bsm_3}
\end{equation}
where $p$ has a radiation boundary at $\sigma$. The time derivative of the influx obeys
\begin{eqnarray}
 \pdiff{}{t} \left. \int d\vect{r_0} p(\vect{r},t|\vect{r_0}) \right|_{r=\sigma} & = & \mathscr{L}_{\vect{r}} \left. \int d\vect{r_0} p(\vect{r},t|\vect{r_0}) \right|_{r=\sigma}.
\end{eqnarray}
When we evaluate \eref{S_eqn} at $r_0=\sigma$, we see, using Kolmogorov \eref{backward_eqn}, that the time derivatives of both quantaties obey the same differential equation. Furthermore, in the limit $t \to 0$, both \eref{bsm_3} and \eref{bsm_k} equal. We conclude that \eref{bsm_k} must hold.


\subsection{\alabel{noise:Seq_approx} Approximating the survival probability in equilibrium}
We want to approximate the survival probability of a promoter in equilibrium sollution
\begin{equation}
 \mathscr{S}_{\rm irr}(t|{\rm eq}) = {\rm exp}\left(-c \int_0^t k_{{\rm irr}}(t') dt'\right) = {\rm exp}\left(-c k_+ \int_0^t S(t'|\sigma) dt'\right)
 \elabel{Seq_app}
\end{equation}
such that it can be Laplace transformed, and has correct behaviour in the limit $s\to0$. A small $s$ limit amounts to a large $t$ limit in the time domain, and because the argument of the exponential will diverge for large $t$, a small argument expansion will not work. The reason for the divergence is because $S(t|\sigma)$ approaches a constant value in the limit $t\to\infty$, and the integral divereges. Because $S(t|\sigma)$ becomes constant, the argument in the exponential scales as a linear function of $t$ to highest order. Written for large times, \eref{Seq_app} is
\begin{equation}
 \mathscr{S}_{\rm irr}(t|{\rm eq}) \sim {\rm exp}\left(-c \left[ \alpha_1 t + \alpha_2 t^{\beta_2} + \ldots \right] \right),
\end{equation}
where the powers $\beta_2$ and higher, are smaller than one. For a low concentration $c$, the highest order in $t$ will dominate. Specifically, if we change coordinates $c\,t\to x$, we get
\begin{equation}
 \mathscr{S}_{\rm irr}(t|{\rm eq}) \sim {\rm exp}\left(-\left[ \alpha_1 x + \alpha_2 c^{1-\beta_2} x^{\beta_2} + \ldots \right] \right).
\end{equation}
and in the limit $c\to0$, only the term linear in $t$ remains. We end with
\begin{equation}
 \lim_{c\to0} \mathscr{S}_{\rm irr}(t|{\rm eq}) = {\rm exp}\left(-c k_+ S(\infty|\sigma) \, t \right).
 \elabel{Seq_app2}
\end{equation}
Another way to appreciate this approximation, is to observe that the time at which the steady-state is reached is independent of the concentration (\eref{bsm_k}). When we lower the concentration, the time at which the promoter is almost certainly occupied, increases. Therefore, in the low concentration limit, the time interval in which the system is not in steady-state, compared to the average time in which a TF from the bulk binds to the promoter, becomes insignificantly small.

Finally, Laplace transforming \eref{Seq_app2}, we get
\begin{equation}
 \lim_{c \to 0} \hat{\mathscr{S}}_{\rm rad}(s|eq) = \frac{1}{s + c \hat{k}_{\rm rad}(\infty)}.
\end{equation}
In the limit of small $s$, we write the more general form used in the main text
\begin{equation}
 \lim_{c \to 0} \hat{\mathscr{S}}_{\rm rad}(s|eq) = \frac{1}{s} \, \frac{1}{1 + c \hat{k}_{\rm rad}(s)}.
\end{equation}

Note that, by using this approximation, we assume the influx into the promoter to be in steady-state for all times. Therefore, the average reaction rate $k_{\rm ss}$, defined as
\begin{equation}
 \frac{1}{c k_{\rm ss}} = \int_0^\infty \mathscr{S}_{\rm irr}(t|{\rm eq}) \, dt = \hat{\mathscr{S}}_{\rm irr}(0|{\rm eq}) = \frac{1}{c k_+ S(\infty|\sigma)},
\end{equation}
is equal to the $t\to\infty$ limit of the time dependent rate coefficient, 
\begin{equation}
 k_{\infty} = \lim_{t \to \infty} k_{{\rm irr}}(t) = k_+ S(\infty|\sigma).
\end{equation}


\subsection{\alabel{noise:promtoconc} Relating promoter state noise to fluctuations in concentration}
The noise in the concentration around the promoter on the DNA, is related to fluctuations in the promoter state, via 
\begin{equation}
 \delta \xi = \left|\frac{\partial \xi}{\partial n}\right| \delta n \quad \Rightarrow \quad  \delta \xi = \frac{\bar{\xi}}{(1-\bar{n})\bar{n}}\delta n,
 \elabel{EqxiNoise}
\end{equation}
and fluctuations in the bulk, using detailed balance, via
\begin{equation}
 \bar{\xi} k_d = \bar{c} k_a \quad \Rightarrow \quad \delta c = \frac{k_a}{k_d} \, \frac{\bar{c}}{(1-\bar{n})\bar{n}}\delta n.
 \elabel{EqcNoise}
\end{equation}


\subsection{\alabel{noise:delta_int} Performing the integral over $\delta(r-\sigma)$}
We want evaluate the fourier transform of the delta function used in solving \eref{FDE_bulk}, where we denote the prefactor as an arbitrary function $f$
\begin{multline}
 \mathscr{F}\left\lbrace \hat{f}(r,z) \frac{\delta(|\mathbf r \mathrm| - \sigma)}{2 \pi \sigma} \right\rbrace 
 = \int_0^{\infty} \int_0^{2 \pi} r\,dr \, d\theta f(r,z) e^{i {\bf k \cdot r}} \frac{\delta(|\mathbf r \mathrm| - \sigma)}{2 \pi \sigma} \\
 = \int_0^{\infty} r\,dr f(r,z) \int_0^{2 \pi} d\theta \left( e^{i k r \, {\rm cos}(\theta - \theta')} \right) \frac{\delta(|\mathbf r \mathrm| - \sigma)}{2 \pi \sigma} \\
 = \int_0^{\infty} r\,dr f(r,z) \left( 2 \pi {\rm J_0}(k r) \right) \frac{\delta(|\mathbf r \mathrm| - \sigma)}{2 \pi \sigma} 
 = f(\sigma, z) {\rm J_0}(k \sigma)
\end{multline}
The first equality is the defenition of the Fourier integral in the plane perpendicular to the DNA. In the second line we write out the innerproduct, where the angle bewteen {\bf k} and {\bf r} is shifted w.r.t. $\theta$. Since we integrate the full circle this shift cancels, and we get a Bessel function of the first kind. The integral over $r$ amount to replacing every accurance of $r$ with $\sigma$.
